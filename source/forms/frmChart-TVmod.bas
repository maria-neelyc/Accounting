Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularFamily =0
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =12850
    DatasheetFontHeight =10
    ItemSuffix =132
    Left =990
    Top =2355
    Right =15390
    Bottom =9600
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xf8f740c57162e240
    End
    Caption ="Contact's File"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BackStyle =0
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
        End
        Begin ListBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
        End
        Begin ComboBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
        End
        Begin Tab
            BackStyle =0
        End
        Begin FormHeader
            Height =1260
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin Image
                    Left =300
                    Top =180
                    Width =900
                    Height =1020
                    Name ="imgHeader"
                    PictureData = Begin
                        0x03000000fc02330108000000c9050000450500007911261b010009000003a809 ,
                        0x00000300c603000000000400000003010800050000000b020000000005000000 ,
                        0x0c02330038000500000006010200000005000000020101000000050000000102 ,
                        0x7f9eff0007000000fc0200007f9eff000000040000002d01000008000000fa02 ,
                        0x05000100000000000000040000002d010100c60300002403e1010f0000000f00 ,
                        0x00000f0000000f0000000f000000100002001100030012000400130004001400 ,
                        0x050015000600160007001700070018000800190009001a0009001b000a001c00 ,
                        0x0a001c000a001d000b001e000b001d000b001c000b001b000a001a000a001900 ,
                        0x0a00180009001700090016000900150008001400080013000700120007001100 ,
                        0x0600100005000f0004000e0004000e0004000e0004000e0004000e0004000f00 ,
                        0x0500100006001100070012000800130008001400090015000a0016000a001700 ,
                        0x0b0018000b0018000c0019000c001a000d001b000d001c000d001d000e001c00 ,
                        0x0e001b000d001a000d0019000d0018000d0017000c0016000c0015000b001400 ,
                        0x0b0013000b0012000a0011000a00100009000f0008000e0008000d0007000d00 ,
                        0x07000d0007000d0007000d0007000e0008000f00090010000a0011000b001200 ,
                        0x0b0013000c0014000c0014000d0015000e0016000e0017000e0018000f001900 ,
                        0x0f001a0010001b0010001c0010001b0010001a00100019001000180010001700 ,
                        0x0f0016000f0015000f0014000e0013000e0012000d0011000d0010000d000f00 ,
                        0x0c000e000c000d000b000c000a000c000a000c000a000c000b000c000b000d00 ,
                        0x0b000e000c000f000d0010000e0010000e0011000f0012000f00130010001400 ,
                        0x10001500110016001100170012001800120019001200190013001a0013001900 ,
                        0x1300180013001800130017001200160012001500120014001100130011001200 ,
                        0x110011001000100010000f0010000e000f000d000f000c000e000b000e000b00 ,
                        0x0e000a000e000a000e000a000e000b000f000c000f000d0010000e0010000f00 ,
                        0x1100100012001100120012001300130013001400140015001400160014001600 ,
                        0x1500170015001800160019001600180016001700160016001500150015001400 ,
                        0x150013001500120014001200140011001400100013000f0013000e0012000c00 ,
                        0x12000b0012000a00110009001100090011000900110009001100090011000a00 ,
                        0x12000b0012000c0013000d0013000e0014000f00150010001500110016001200 ,
                        0x1600130016001400170014001700150018001600180017001800180019001700 ,
                        0x1900160018001500180014001800130018001200170011001700100017000f00 ,
                        0x17000e0016000d0016000c0015000b0015000a00150009001400080014000800 ,
                        0x1400080014000800140008001400090015000a0015000b0016000c0016000d00 ,
                        0x17000e0018000f00180010001900110019001100190012001a0013001a001400 ,
                        0x1b0015001b0016001b0017001c0016001c0015001b0014001b0013001b001200 ,
                        0x1b0011001a0010001a000f001a000e001a000d0019000c0019000b0018000a00 ,
                        0x1800090018000800170007001700070017000700170006001700060017000800 ,
                        0x1800090018000a0019000b001a000c001a000d001b000d001b000e001c000f00 ,
                        0x1c0010001c0011001d0012001d0013001e0014001e0015001e0016001f001500 ,
                        0x1f0014001e0013001e0012001e0011001e0010001e000f001d000e001d000d00 ,
                        0x1d000c001c000b001c000a001c0009001b0007001b0006001a0005001a000500 ,
                        0x1a0005001a0005001a0005001a0006001b0007001b0008001c0009001d000a00 ,
                        0x1d000b001e000c001e000d001f000e001f000f00200010002000110020001200 ,
                        0x2100130021001400210015002200140022001300210012002100110021001000 ,
                        0x21000f0021000e0020000d0020000c0020000b001f0009001f0008001f000700 ,
                        0x1e0006001e0005001d0004001d0004001d0004001d0003001d0003001d000500 ,
                        0x1e0006001e0007001f0008002000090020000a0021000b0021000c0022000d00 ,
                        0x22000e0023000f00230010002400110024001200240013002500140025001300 ,
                        0x25001200250011002400100024000f0024000e0024000d0024000b0023000a00 ,
                        0x2300090023000800220007002200060021000500210003002000020020000200 ,
                        0x2000020020000200200002002000030021000400210005002200060023000800 ,
                        0x2300090024000a0025000b0025000c0026000d0026000e0026000f0027001000 ,
                        0x27001100280012002800130028001200280011002800100028000f0028000d00 ,
                        0x27000c0027000b0027000a002700090026000800260007002600060025000400 ,
                        0x2500030024000200230000002300000023000000230000002300000023000200 ,
                        0x2400040025000600260007002700090028000b0028000c0029000e0029000f00 ,
                        0x2a0011002a0012002a0013002a0015002b0016002b0017002b0018002b001a00 ,
                        0x2b001b002b001c002c001d002c001e002c001f002c0021002d0022002d002300 ,
                        0x2d0024002e0025002f0026002f0027003000290031002a0032002b0033002b00 ,
                        0x31002c002f002c002d002d002b002d0028002e0027002e0025002f0023003000 ,
                        0x210031001f0032001d0033001c0034001a003500190037001700380016003700 ,
                        0x14003600130035001200330011003200100031000f0030000e002f000e002e00 ,
                        0x0d002c000d002b000d002a000c0029000c0028000c0026000b0025000b002400 ,
                        0x0b0023000b0021000a0020000a001f000a001e0009001c0009001b0008001900 ,
                        0x08001800070017000600150005001400040012000300110002000f0000000500 ,
                        0x000001020000000007000000fc020000000000000000040000002d0102000400 ,
                        0x0000f0010000040000002d010100a200000024034f0015001500150014001400 ,
                        0x1400140014001400140014001400140014001300140013001400130014001300 ,
                        0x140013001400120014001200140012001000130010001300100013000f001300 ,
                        0x0f0013000f0013000f0013000f0013000e0012000e0012000e0012000e001200 ,
                        0x0e0012000e0011000e0011000e0011000e0011000f0011000f0011000f001100 ,
                        0x0f0011000f001100100011001000110010001100140011001500110015001100 ,
                        0x1500110015001100150011001600110016001000160010002000110020001100 ,
                        0x2100110021001100210011002200110022001200220012002200120022001200 ,
                        0x2200130022001300220013002200130022001400220014002200140022001400 ,
                        0x2200140022001500220015002100150021001500210015002000150020001500 ,
                        0x160015001600150015001500150015001500050000000102ffffff0007000000 ,
                        0xfc020000ffffff000000040000002d01000004000000f0010200040000002d01 ,
                        0x0100660000002403310015002000140020001400200014002100140021001400 ,
                        0x2100140021001300210013002100130021001300210012002100120021001200 ,
                        0x2100120021001200210012002100120021001200210012002000110020001100 ,
                        0x2000110016001100160012001600120015001200150012001500120015001200 ,
                        0x1500120015001200150012001500130015001300150013001500130015001300 ,
                        0x1500140015001400150014001500140015001400150014001500140015001400 ,
                        0x16001400160015001600150020000500000001020000000007000000fc020000 ,
                        0x000000000000040000002d01020004000000f0010000040000002d010100be00 ,
                        0x000024035d002d0016002d0014002d0014002d0013002d0013002d0013002c00 ,
                        0x13002c0012002c0012002c0012002c0012002b0012002b0012002b0012002a00 ,
                        0x12002a0011002a0011002a0011002b0010002b0010002b0010002b000f002b00 ,
                        0x0f002c000f001e000f001e000f001e000f001d000f001d000f001d0010001d00 ,
                        0x10001c0011001c0011001c001200190012001800120018001200170012001700 ,
                        0x1300170013001600130016001400160014001600210016002200160022001700 ,
                        0x2300170023001700230017002300180023001800230018002300180023001800 ,
                        0x2400190024001b0024001b0024001b0025001a0026001a0027001a0027001900 ,
                        0x2800190028001900280018002900260029002600290026002900270028002700 ,
                        0x280028002700280027002800260029002500290024002b0024002b0024002b00 ,
                        0x23002c0023002c0023002c0023002c0023002c0023002d0023002d0023002d00 ,
                        0x22002d0022002d0021002d0018002e0018002e0016002d001600050000000102 ,
                        0xffffff0007000000fc020000ffffff000000040000002d01000004000000f001 ,
                        0x0200040000002d0101003a00000024031b001e0010002a001000290010002900 ,
                        0x1100290012002800130028001400280015002800160028001700280017002800 ,
                        0x170028001700280017001c0017001c0017001c0017001c0017001c0017001c00 ,
                        0x15001c0014001c0013001d0012001d0011001e0010001e0010001e0010000500 ,
                        0x00000102ffffff0007000000fc020000ffffff000000040000002d0102000400 ,
                        0x0000f0010000040000002d0101002a00000024031300260028001a0028001b00 ,
                        0x28001b0027001b0027001b0026001c0026001c0025001c0024001c0024002800 ,
                        0x2400280024002800250027002600270027002700270026002700260028002600 ,
                        0x2800050000000102ffffff0007000000fc020000ffffff000000040000002d01 ,
                        0x000004000000f0010200040000002d0101008200000024033f002c0021002c00 ,
                        0x22002c0022002c0022002c0022002c0022002c0022002b0022002b0023001900 ,
                        0x2300180023001800220018002200180022001800220018002200180022001800 ,
                        0x2200180022001700220017002200170021001700140017001400170014001800 ,
                        0x1400180013001800130018001300180013001800130018001300180013001800 ,
                        0x1300190013001b0013001b0013001b0014001b0014001b001500190015001900 ,
                        0x18002b0018002b00150029001500290014002900140029001300290013002b00 ,
                        0x13002b0013002b0013002b0013002c0013002c0013002c0013002c0013002c00 ,
                        0x13002c0014002c0014002c0014002c0014002c00210005000000010200000000 ,
                        0x07000000fc020000000000000000040000002d01020004000000f00100000400 ,
                        0x00002d0101004e00000024032500290021002a0021002a0021002a0020002a00 ,
                        0x20002a0020002b0020002b0020002b0020002b001b002b001b002b001b002a00 ,
                        0x1a002a001a002a001a002a001a002a001a0029001a0022001a0022001a002200 ,
                        0x1a0021001a0021001a0021001a0021001b0021001b0021001b00210020002100 ,
                        0x2000210020002100200021002000210020002200210022002100220021002900 ,
                        0x2100050000000102ffffff0007000000fc020000ffffff000000040000002d01 ,
                        0x000004000000f0010200040000002d0101004600000024032100220020002200 ,
                        0x2000220020002200200022002000220020002200200022002000220020002200 ,
                        0x1b0022001b0022001b0022001b0022001b0022001b0022001b0022001b002200 ,
                        0x1b0029001b002a001b002a001b002a001b002a001b002a001b002a001b002a00 ,
                        0x1b002a001b002a0020002a0020002a0020002a00200029002000220020000500 ,
                        0x000001020000000007000000fc020000000000000000040000002d0102000400 ,
                        0x0000f0010000040000002d0101000e000000240305001b001c001b001b001900 ,
                        0x1b0019001c001b001c000500000001020000000007000000fc02000000000000 ,
                        0x0000040000002d01000004000000f0010200040000002d0101000e0000002403 ,
                        0x05001d001c001d001b001c001b001c001c001d001c0005000000010200000000 ,
                        0x07000000fc020000000000000000040000002d01020004000000f00100000400 ,
                        0x00002d0101000e000000240305001f001c001f001b001e001b001e001c001f00 ,
                        0x1c000500000001020000000007000000fc020000000000000000040000002d01 ,
                        0x000004000000f0010200040000002d0101000e000000240305001b001e001b00 ,
                        0x1d0019001d0019001e001b001e000500000001020000000007000000fc020000 ,
                        0x000000000000040000002d01020004000000f0010000040000002d0101000e00 ,
                        0x0000240305001d001e001d001d001c001d001c001e001d001e00050000000102 ,
                        0x0000000007000000fc020000000000000000040000002d01000004000000f001 ,
                        0x0200040000002d0101000e000000240305001f001e001f001d001e001d001e00 ,
                        0x1e001f001e000500000001020000000007000000fc0200000000000000000400 ,
                        0x00002d01020004000000f0010000040000002d0101000e000000240305002900 ,
                        0x1d0029001c0023001c0023001d0029001d000500000001020000000007000000 ,
                        0xfc020000000000000000040000002d01000004000000f0010200040000002d01 ,
                        0x01000e0000002403050029001f0029001e0023001e0023001f0029001f000500 ,
                        0x000001020000000007000000fc020000000000000000040000002d0102000400 ,
                        0x0000f0010000040000002d0101000e000000240305001b0020001b001f001900 ,
                        0x1f00190020001b0020000500000001020000000007000000fc02000000000000 ,
                        0x0000040000002d01000004000000f0010200040000002d0101000e0000002403 ,
                        0x05001d0020001d001f001c001f001c0020001d00200005000000010200000000 ,
                        0x07000000fc020000000000000000040000002d01020004000000f00100000400 ,
                        0x00002d0101000e000000240305001f0020001f001f001e001f001e0020001f00 ,
                        0x2000030000000000
                    End
                    Picture ="C:\\TheBill\\Icons\\fax.wmf"
                End
                Begin Label
                    OverlapFlags =85
                    Left =1320
                    Top =180
                    Width =6900
                    Height =960
                    Name ="lblComent"
                    Caption ="Chart Of Accounts"
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =5338
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin ListBox
                    OverlapFlags =215
                    ColumnCount =5
                    Left =195
                    Top =480
                    Width =2438
                    Height =4050
                    Name ="lstlvl1"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblCha"
                        "rt.lvlID, Right(\"0\" & tblChart.coaRef1,2) & Right(\"0\" & tblChart.coaRef2,2) "
                        "& Right(\"0\" & tblChart.coaRef3,2) & Right(\"0\" & tblChart.coaRef4,2) & Right("
                        "\"00\" & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.lvlID)=1)"
                        "); "
                    ColumnWidths ="0;4466;0;0;0"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =195
                            Top =240
                            Width =2010
                            Height =240
                            Name ="Label100"
                            Caption ="Level I"
                        End
                    End
                End
                Begin OptionGroup
                    OverlapFlags =223
                    Left =75
                    Top =60
                    Width =12660
                    Height =5115
                    TabIndex =1
                    Name ="Frame103"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =188
                    Top =4582
                    Width =795
                    TabIndex =2
                    Name ="cmdAddLvl1"
                    Caption ="Add"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =1020
                    Top =4575
                    Width =765
                    TabIndex =3
                    Name ="cmdEditLvl1"
                    Caption ="Edit"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =1830
                    Top =4575
                    Width =795
                    TabIndex =4
                    Name ="cmdDeleteLvl1"
                    Caption ="Delete"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Close Current Form"
                End
                Begin ListBox
                    OverlapFlags =215
                    ColumnCount =5
                    Left =2693
                    Top =480
                    Width =2438
                    Height =4050
                    TabIndex =5
                    Name ="lstlvl2"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="0;4467;0;0;0"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =223
                            Left =2692
                            Top =236
                            Width =2010
                            Height =240
                            Name ="Label113"
                            Caption ="Level II"
                        End
                    End
                End
                Begin ListBox
                    OverlapFlags =215
                    ColumnCount =5
                    Left =5175
                    Top =480
                    Width =2438
                    Height =4050
                    TabIndex =6
                    Name ="lstlvl3"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="0;4468;0;0;0"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =223
                            Left =5175
                            Top =240
                            Width =2010
                            Height =240
                            Name ="Label115"
                            Caption ="Level III"
                        End
                    End
                End
                Begin ListBox
                    OverlapFlags =215
                    ColumnCount =5
                    Left =7665
                    Top =480
                    Width =2438
                    Height =4050
                    TabIndex =7
                    Name ="lstlvl4"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="0;4468;0;0;0"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =223
                            Left =7665
                            Top =240
                            Width =2010
                            Height =240
                            Name ="Label117"
                            Caption ="Level IV"
                        End
                    End
                End
                Begin ListBox
                    OverlapFlags =215
                    ColumnCount =5
                    Left =10170
                    Top =480
                    Width =2438
                    Height =4050
                    TabIndex =8
                    Name ="lstlvl5"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="0;4468;0;0;0"
                    Begin
                        Begin Label
                            OverlapFlags =223
                            Left =10170
                            Top =240
                            Width =2010
                            Height =240
                            Name ="Label119"
                            Caption ="Level 5"
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =2715
                    Top =4582
                    Width =795
                    TabIndex =9
                    Name ="cmdAddLvl2"
                    Caption ="Add"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =3547
                    Top =4575
                    Width =765
                    TabIndex =10
                    Name ="cmdEditLvl2"
                    Caption ="Edit"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =4357
                    Top =4575
                    Width =795
                    TabIndex =11
                    Name ="cmdDeleteLvl2"
                    Caption ="Delete"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =5190
                    Top =4582
                    Width =795
                    TabIndex =12
                    Name ="cmdAddLvl3"
                    Caption ="Add"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =6022
                    Top =4575
                    Width =765
                    TabIndex =13
                    Name ="cmdEditLvl3"
                    Caption ="Edit"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =6832
                    Top =4575
                    Width =795
                    TabIndex =14
                    Name ="cmdDeleteLvl3"
                    Caption ="Delete"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =7695
                    Top =4582
                    Width =795
                    TabIndex =15
                    Name ="cmdAddLvl4"
                    Caption ="Add"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =8527
                    Top =4575
                    Width =765
                    TabIndex =16
                    Name ="Command127cmdEditLvl4"
                    Caption ="Edit"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =9337
                    Top =4575
                    Width =795
                    TabIndex =17
                    Name ="Command128cmdDeleteLvl4"
                    Caption ="Delete"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =10185
                    Top =4582
                    Width =795
                    TabIndex =18
                    Name ="cmdAddLvl5"
                    Caption ="Add"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =11017
                    Top =4575
                    Width =765
                    TabIndex =19
                    Name ="cmdEditLvl5"
                    Caption ="Edit"
                    ControlTipText ="Close Current Form"
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =11827
                    Top =4575
                    Width =795
                    TabIndex =20
                    Name ="cmdDeleteLvl5"
                    Caption ="Delete"
                    ControlTipText ="Close Current Form"
                End
            End
        End
        Begin FormFooter
            Height =590
            BackColor =-2147483633
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =80
                    Left =6075
                    Top =135
                    Width =1080
                    Name ="cmdPrint"
                    Caption ="&Print"
                    ControlTipText ="Delete Record"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =88
                    Left =7215
                    Top =135
                    Width =1080
                    Height =345
                    TabIndex =1
                    Name ="cmdExit"
                    Caption ="E&xit"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Close Current Form"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Sub btnAddSub_Click()

If IsNull(cboAccount) = False Then
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add4" & cboAccount.Column(0) & "_" & cboAccount.Column(5)
    Else
        strPar = "add4" & cboAccount.Column(0) & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    DoCmd.OpenForm "frmChartAdd", , , , , , strPar
End If

If IsNull(cboDepartment) = False Then
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add4" & cboDepartment.Column(0) & "_" & cboDepartment.Column(5)
    Else
        strPar = "add4" & cboDepartment.Column(0) & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    DoCmd.OpenForm "frmChartAdd", , , , , , strPar
End If

If IsNull(cboGroup) = False Then
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add4" & cboGroup.Column(0) & "_" & cboGroup.Column(5)
    Else
        strPar = "add4" & cboGroup.Column(0) & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    DoCmd.OpenForm "frmChartAdd", , , , , , strPar
Else
    MsgBox "Select Category First"
End If

End Sub

Private Sub cboAccount_Change()
If IsNull(cboAccount) = False Then
    cboSubAccount.RowSource = "SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.coaIDg)<>[coaID] And (tblChart.lvlID = 4) And (tblChart.coaIDg)=" & cboAccount & "));"
    lstAccount.RowSource = "SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.coaIDg)<>[coaID] And (tblChart.coaIDg)=" & cboAccount & "));"
    cboSubAccount.Value = Null
End If

If IsNull(cboSubAccount) = True Or cbSubAccount = Empty Then
   btnAddSub.Enabled = True
Else
   btnAddSub.Enabled = False
End If

End Sub

Private Sub cboDepartment_Change()
If IsNull(cboDepartment) = False Then
    cboAccount.RowSource = "SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.coaIDg)<>[coaID] And (tblChart.lvlID = 3) And (tblChart.coaIDg)=" & cboDepartment & "));"
    lstAccount.RowSource = "SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.coaIDg)<>[coaID] And (tblChart.coaIDg)=" & cboDepartment & "));"
    cboAccount.Value = Null
    cboSubAccount.Value = Null
End If

If IsNull(cbSubAccount) = True Or cbSubAccount = Empty Then
   btnAddSub.Enabled = True
Else
   btnAddSub.Enabled = False
End If

End Sub

Private Sub cboGroup_Change()
If IsNull(cboGroup) = False Then
    cboDepartment.RowSource = "SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.coaIDg)<>[coaID] And (tblChart.lvlID = 2) And (tblChart.coaIDg)=" & cboGroup & "));"
    lstAccount.RowSource = "SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.coaIDg)<>[coaID] And (tblChart.coaIDg)=" & cboGroup & "));"
    cboDepartment.Value = Null
    cboAccount.Value = Null
    cboSubAccount.Value = Null
    lstAccount.Requery
End If

If IsNull(cboSubAccount) = True Or cbSubAccount = Empty Then
   btnAddSub.Enabled = True
Else
   btnAddSub.Enabled = False
End If

End Sub

Private Sub cboSubAccount_Change()
If IsNull(cboSubAccount) = False Then
    lstAccount.RowSource = "SELECT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef FROM tblChart WHERE (((tblChart.coaIDg)<>[coaID] And (tblChart.coaIDg)=" & cboSubAccount & "));"
    btnAddSub.Enabled = False
Else
    btnAddSub.Enabled = True
End If

End Sub

Private Sub cmdAdd_Click()
Dim strPar As String

If IsNull(cboSubAccount) = False Then
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add" & cboSubAccount.Column(4) & cboSubAccount.Column(0) & "_" & cboSubAccount.Column(5)
    Else
        strPar = "add" & cboSubAccount.Column(4) & cboSubAccount.Column(0) & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    GoTo Exit_Sub
End If

If IsNull(cboAccount) = False Then
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add" & cboAccount.Column(4) & cboAccount.Column(0) & "_" & cboAccount.Column(5)
    Else
        strPar = "add" & cboAccount.Column(4) & cboAccount.Column(0) & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    GoTo Exit_Sub
End If

If IsNull(cboDepartment) = False Then
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add" & cboDepartment.Column(4) & cboDepartment.Column(0) & "_" & cboDepartment.Column(5)
    Else
        strPar = "add" & cboDepartment.Column(4) & cboDepartment.Column(0) & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    GoTo Exit_Sub
End If

If IsNull(cboGroup) = False Then
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add" & cboGroup.Column(4) & cboGroup.Column(0) & "_" & cboGroup.Column(5)
    Else
        strPar = "add" & cboGroup.Column(4) & cboGroup.Column(0) & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    GoTo Exit_Sub
Else
    If IsNull(lstAccount.Column(5, lstAccount.ListCount - 1)) Then
        strPar = "add00" & "_00000000000"
    Else
        strPar = "add00" & "_" & lstAccount.Column(5, lstAccount.ListCount - 1)
    End If
    GoTo Exit_Sub
End If

Exit_Sub:
DoCmd.OpenForm "frmChartAdd", , , , , , strPar
End Sub

Private Sub cmdDelete_Click()

    Dim strSQL As String
    Dim rs As Recordset
    
    Select Case lstAccount.Column(4, lstAccount.ListIndex)
        Case 1
            strSQL = "SELECT tblTransactionSub.trnsID " _
                   & "FROM (tblAccount INNER JOIN tblTransactionSub ON tblAccount.accID = tblTransactionSub.accID) INNER JOIN tblChart ON tblAccount.caoID = tblChart.coaID " _
                   & "WHERE tblChart.coaRef1 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 1)
        Case 2
            strSQL = "SELECT tblTransactionSub.trnsID " _
                   & "FROM (tblAccount INNER JOIN tblTransactionSub ON tblAccount.accID = tblTransactionSub.accID) INNER JOIN tblChart ON tblAccount.caoID = tblChart.coaID " _
                   & "WHERE tblChart.coaRef1 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 1) & " AND " _
                   & "      tblChart.coaRef2 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 2)
        Case 3
            strSQL = "SELECT tblTransactionSub.trnsID " _
                   & "FROM (tblAccount INNER JOIN tblTransactionSub ON tblAccount.accID = tblTransactionSub.accID) INNER JOIN tblChart ON tblAccount.caoID = tblChart.coaID " _
                   & "WHERE tblChart.coaRef1 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 1) & " AND " _
                   & "      tblChart.coaRef2 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 2) & " AND " _
                   & "      tblChart.coaRef3 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 3)
        Case 4
            strSQL = "SELECT tblTransactionSub.trnsID " _
                   & "FROM (tblAccount INNER JOIN tblTransactionSub ON tblAccount.accID = tblTransactionSub.accID) INNER JOIN tblChart ON tblAccount.caoID = tblChart.coaID " _
                   & "WHERE tblChart.coaRef1 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 1) & " AND " _
                   & "      tblChart.coaRef2 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 2) & " AND " _
                   & "      tblChart.coaRef3 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 3) & " AND " _
                   & "      tblChart.coaRef4 = " & SplitRef(lstAccount.Column(5, lstAccount.ListIndex), 4)
        Case 5
            strSQL = "SELECT tblTransactionSub.trnsID " _
                   & "FROM (tblAccount INNER JOIN tblTransactionSub ON tblAccount.accID = tblTransactionSub.accID) INNER JOIN tblChart ON tblAccount.caoID = tblChart.coaID " _
                   & "WHERE tblChart.coaID = " & lstAccount.Value
    End Select

    Set rs = CurrentDb.OpenRecordset(strSQL)
    
    If rs.RecordCount > 0 Then
       MsgBox FnIsErr(7001), vbExclamation
       rs.Close
       Exit Sub
    End If
    
    strSQL = "SELECT coaID " _
           & "FROM tblChart " _
           & "WHERE coaIDg = " & lstAccount.Value
           
    Set rs = CurrentDb.OpenRecordset(strSQL)
    
    If rs.RecordCount > 0 Then
       MsgBox FnIsErr(7002), vbExclamation
       rs.Close
       Exit Sub
    End If
           
    strSQL = "SELECT accID " _
           & "FROM tblAccount " _
           & "WHERE caoID = " & lstAccount.Value
           
    Set rs = CurrentDb.OpenRecordset(strSQL)
    
    If rs.RecordCount > 0 Then
        If MsgBox(FnIsErr(7003), vbOKCancel, "Delete Reference") = vbOK Then
            DoCmd.SetWarnings False
            strSQL = "DELETE from tblChart WHERE coaID=" & lstAccount.Value
            FnLog (strSQL)
            DoCmd.RunSQL (strSQL)
            DoCmd.SetWarnings True
            lstAccount.Requery
        End If
    End If
    rs.Close
End Sub

Private Sub cmdEdit_Click()
Dim strPara As String
If lstAccount.ItemsSelected.Count = 0 Then
    MsgBox "Select Item First"
    Exit Sub
Else
    strPara = "edt" & lstAccount.Value
    DoCmd.OpenForm "frmChartAdd", , , , , , strPara
End If
End Sub

Private Sub cmdExit_Click()
If IsNoData(Me.OpenArgs) Then
    DoCmd.OpenForm "frmMain"
    DoCmd.Close acForm, Me.name
Else
    Select Case Me.OpenArgs
        Case "frmAccount"
            DoCmd.Close acForm, "frmChart"
            'Screen.ActiveForm.Refresh
            Forms.frmAccount.Modal = True
        Case Else
    End Select
End If
End Sub

Private Sub lstlvl1_Click()
lstlvl2.RowSource = "SELECT DISTINCT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef " _
                  & "FROM tblChart " _
                  & "WHERE tblChart.coaIDg<>[coaID] " _
                  & "AND tblChart.coaIDg=" & lstlvl1.Value _
                  & " AND tblChart.lvlID <> 5"
lstlvl3.RowSource = ""
lstlvl4.RowSource = ""
lstlvl5.RowSource = "SELECT DISTINCT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef " _
                  & "FROM tblChart " _
                  & "WHERE tblChart.coaIDg<>[coaID] " _
                  & "AND tblChart.coaIDg=" & lstlvl1.Value _
                  & " AND tblChart.lvlID = 5"
lstlvl2 = ""
lstlvl3 = ""
lstlvl4 = ""
lstlvl5 = ""
End Sub

Private Sub lstlvl2_Click()
lstlvl3.RowSource = "SELECT DISTINCT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef " _
                  & "FROM tblChart " _
                  & "WHERE tblChart.coaIDg<>[coaID] " _
                  & "AND tblChart.coaIDg=" & lstlvl2.Value _
                  & " AND tblChart.lvlID <> 5"
lstlvl4.RowSource = ""
lstlvl5.RowSource = "SELECT DISTINCT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef " _
                  & "FROM tblChart " _
                  & "WHERE tblChart.coaIDg<>[coaID] " _
                  & "AND tblChart.coaIDg=" & lstlvl2.Value _
                  & " AND tblChart.lvlID = 5"
lstlvl3 = ""
lstlvl4 = ""
lstlvl5 = ""
End Sub

Private Sub lstlvl3_Click()
lstlvl4.RowSource = "SELECT DISTINCT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef " _
                  & "FROM tblChart " _
                  & "WHERE tblChart.coaIDg<>[coaID] " _
                  & "AND tblChart.coaIDg=" & lstlvl3.Value _
                  & " AND tblChart.lvlID <> 5"

lstlvl5.RowSource = "SELECT DISTINCT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef " _
                  & "FROM tblChart " _
                  & "WHERE tblChart.coaIDg<>[coaID] " _
                  & "AND tblChart.coaIDg=" & lstlvl3.Value _
                  & " AND tblChart.lvlID = 5"
lstlvl4 = ""
lstlvl5 = ""
End Sub

Private Sub lstlvl4_Click()
lstlvl5.RowSource = "SELECT DISTINCT tblChart.coaID, tblChart.coaName, tblChart.coaNo, tblChart.coaIDg, tblChart.lvlID, Right(Chr(48) & tblChart.coaRef1,2)&Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef " _
                  & "FROM tblChart " _
                  & "WHERE tblChart.coaIDg<>[coaID] " _
                  & "AND tblChart.coaIDg=" & lstlvl4.Value _
                  & " AND tblChart.lvlID = 5"
lstlvl5 = ""
End Sub

Private Sub UpdateButtons()

If lstlvl1.ListCount = 0 Then
    cmdEditLvl1.Enabled = False
    cmdDeleteLvl1.Enabled = False
Else
    cmdEditLvl1.Enabled = True
    cmdDeleteLvl1.Enabled = True
End If

If lstlvl2.ListCount = 0 Then
    If lstlvl1.ListCount = 0 Then
        cmdAddLvl2.Enabled = False
        cmdEditLvl2.Enabled = False
        cmdDeleteLvl2.Enabled = False
    Else
        cmdAddLvl2.Enabled = True
        cmdEditLvl2.Enabled = False
        cmdDeleteLvl2.Enabled = False
    End If
Else
    cmdAddLvl2.Enabled = True
    If lstlvl2 = "" Then
        cmdEditLvl2.Enabled = False
        cmdDeleteLvl2.Enabled = False
    Else
        cmdEditLvl2.Enabled = True
        cmdDeleteLvl2.Enabled = True
    End If
End If


If lstlvl3.ListCount = 0 _
Or (lstlvl3.ListCount = 1 And lstlvl3.Recordset Is Nothing) Then
    If lstlvl2.ListCount = 0 _
    Or (lstlvl2.ListCount = 1 And lstlvl2.Recordset Is Nothing) Then
        cmdAddLvl3.Enabled = False
        cmdEditLvl3.Enabled = False
        cmdDeleteLvl3.Enabled = False
    Else
        If IsNumeric(lstlvl2) And lstlvl2 > 0 Then
            cmdAddLvl3.Enabled = True
        Else
            cmdAddLvl3.Enabled = False
        End If
        cmdEditLvl3.Enabled = False
        cmdDeleteLvl3.Enabled = False
    End If
Else
    cmdAddLvl3.Enabled = True
    If lstlvl3 > 0 Then
        cmdEditLvl3.Enabled = True
        cmdDeleteLvl3.Enabled = True
    Else
        cmdEditLvl3.Enabled = False
        cmdDeleteLvl3.Enabled = False
    End If
End If


End Sub
