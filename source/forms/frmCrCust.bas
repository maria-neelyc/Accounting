Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularCharSet =238
    TabularFamily =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =7766
    DatasheetFontHeight =10
    ItemSuffix =4
    Left =18855
    Top =1815
    Right =27015
    Bottom =9795
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xb56603812da7e340
    End
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xae050000ae050000ae050000ae05000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin CommandButton
            TextFontCharSet =238
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
        End
        Begin CustomControl
            SpecialEffect =2
            Width =4536
            Height =2835
        End
        Begin Section
            Height =6916
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =113
                    Top =161
                    Width =7590
                    Height =6015
                    AutoActivate =1
                    Name ="xMyTreeview"
                    OleData = Begin
                        0x000e0000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf028362800000000000000000000000040712fe4bbc1ca010700000000010000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000020000006a000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fefffffffdfffffffffffffffffffffffffffffffffffffffeffffff ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf0283628000000000000000000000000502cf205bcc1ca010500000000010000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000020000006a000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff03000000feffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x73737300eeeeee00ffffff00ffffff00ffffff00ffffff00ffffff00ffffff00 ,
                        0xffffff00b69041c78985d111b16a00c0f028362821433412080000004c340000 ,
                        0x72290000b13cc16a01000600220000009c000000e803000009000000c1cd5a0b ,
                        0x01efcdab0000050090cf5a0b0600000000000000050000805ce6130001000000 ,
                        0x5c001fdeecbd01000500a0e61300ff00ffffff00ffffff00ffffff00ffffff00 ,
                        0xffffff00ffffff00cbcbcb007575750039393900141414000000000000000000 ,
                        0x0909090021212100292929001111110000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x73737300eeeeee00ffffff00ffffff00f9f9f900f3f3f300f6f6f600fbfbfb00 ,
                        0xffffff00ffffff00dddddd00a5a5a50067676700242424000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x73737300eeeeee00ffffff00ffffff00e1e1e100bdbdbd00cecece00f1f1f100 ,
                        0xffffff0000000000
                    End
                    OLEClass ="TreeCtrl"
                    Class ="MSComctlLib.TreeCtrl.2"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =67
                    TextFontCharSet =0
                    Left =6540
                    Top =6360
                    Width =1050
                    Height =360
                    TabIndex =1
                    ForeColor =0
                    Name ="cmdCancel"
                    Caption ="&Cancel"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Close Current Form"
                    UnicodeAccessKey =67
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =79
                    TextFontCharSet =0
                    Left =5400
                    Top =6360
                    Width =1050
                    Height =360
                    TabIndex =2
                    ForeColor =0
                    Name ="cmdOK"
                    Caption ="&OK"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Close Current Form"
                    UnicodeAccessKey =79
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub cmdCancel_Click()
    DoCmd.Close acForm, Me.name
End Sub

Private Sub cmdOK_Click()
    DoCmd.Close acForm, Me.name
End Sub

Private Sub Form_Load()
    PopulateTreeView ("0")
End Sub
Private Sub xMyTreeview_NodeCheck(ByVal Node As Object)
    Dim nodItem As Node

    If Node.Children > 0 Then
        'Check for children nodes.
        Set nodItem = Node.Child
        'Get first child node.
        Do
            nodItem.Checked = True
            If nodItem = nodItem.LastSibling Then
                'This is the last node.
                Exit Do
            Else
                'Get the next node.
                Set nodItem = nodItem.Next
            End If
        Loop
    End If
End Sub


Public Sub PopulateTreeView(selcoaID As String)

Me.xMyTreeview.Nodes.Clear

Dim rs As Recordset
Dim strSQL As String

strSQL = "SELECT coaID, lvlID, coaName, Right(Chr(48) & tblChart.coaRef1,2) & Right(Chr(48) & tblChart.coaRef2,2)&Right(Chr(48) & tblChart.coaRef3,2)&Right(Chr(48) & tblChart.coaRef4,2)&Right(Chr(48)&Chr(48) & tblChart.coaRef5,3) AS coaRef, coaIDg, coaRef1, coaRef2, coaRef3, coaRef4, coaRef5 " _
       & "FROM tblChart " _
       & "ORDER BY lvlID, coaRef1, coaRef2, coaRef3, coaRef4, coaRef5"

Set rs = CurrentDb.OpenRecordset(strSQL)
If rs.RecordCount = 0 Then
'    Me.cmdAdd5th.Enabled = False
'    Me.cmdAddSub.Enabled = False
'    Me.cmdEdit.Enabled = False
'    Me.cmdDelete.Enabled = False
    Exit Sub
Else
'    Me.cmdAdd5th.Enabled = True
'    Me.cmdEdit.Enabled = True
'    Me.cmdDelete.Enabled = True
End If
rs.MoveFirst
Do Until rs.EOF
    If rs!lvlID = 1 Then
       With Me.xMyTreeview.Nodes.Add(Text:=Choose(rs!lvlID, rs!coaRef1, rs!coaRef2, rs!coaRef3, rs!coaRef4, rs!coaRef5) & ". " & rs!coaName, _
            Key:="a" & CStr(rs!coaID))
            .Expanded = True
            .tag = CStr(rs!lvlID) & "_" & rs!coaRef
        End With
    Else
        With Me.xMyTreeview.Nodes.Add(Relationship:=tvwChild, _
            Relative:="a" & CStr(rs!coaIDg), _
            Text:=Choose(rs!lvlID, rs!coaRef1, rs!coaRef2, rs!coaRef3, rs!coaRef4, rs!coaRef5) & ". " & rs!coaName, Key:="a" & CStr(rs!coaID))
            .Expanded = True
            .tag = CStr(rs!lvlID) & "_" & rs!coaRef
            If rs!lvlID = 5 Then
                .ForeColor = vbGrayText
            End If
        End With
    End If
    rs.MoveNext
Loop
rs.Close
Set rs = Nothing
    
If Me.xMyTreeview.Nodes.Count = 0 Then
    cmdAddSub.Enabled = False
    cmdAdd5th.Enabled = False
End If

If selcoaID = "0" Then
    Me.xMyTreeview.Nodes.item(1).Selected = True
    Me.xMyTreeview.Nodes.item(1).EnsureVisible
Else
    Me.xMyTreeview.Nodes(selcoaID).Selected = True
    Me.xMyTreeview.Nodes(selcoaID).EnsureVisible
    If Left(Me.xMyTreeview.SelectedItem.tag, 1) = 5 Then
'        Me.cmdAddLvl.SetFocus
'        Me.cmdAddSub.Enabled = False
        'Me.cmdAdd5th.Enabled = False
    Else
'        Me.cmdAddSub.Enabled = True
    End If
End If
End Sub
